<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="headlogo_admin.png" type="image/png">
    <title>Admin Space</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', sans-serif;
        }

        body {
            display: flex;
            min-height: 100vh;
            background-color: #fafafa;
            color: #1a1a1a;
        }

        /* Loader Styles */
        #page-loader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #fafafa;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.5s ease-out;
        }

        .loader {
            width: 48px;
            height: 48px;
            position: relative;
        }

        .loader:before {
            content: '';
            width: 48px;
            height: 5px;
            background: rgba(59, 130, 246, 0.2);
            position: absolute;
            top: 60px;
            left: 0;
            border-radius: 50%;
            animation: shadow324 0.5s linear infinite;
        }

        .loader:after {
            content: '';
            width: 100%;
            height: 100%;
            background: #3b82f6;
            position: absolute;
            top: 0;
            left: 0;
            border-radius: 4px;
            animation: jump7456 0.5s linear infinite;
        }

        @keyframes jump7456 {
            15% {
                border-bottom-right-radius: 3px;
            }

            25% {
                transform: translateY(9px) rotate(22.5deg);
            }

            50% {
                transform: translateY(18px) scale(1, .9) rotate(45deg);
                border-bottom-right-radius: 40px;
            }

            75% {
                transform: translateY(9px) rotate(67.5deg);
            }

            100% {
                transform: translateY(0) rotate(90deg);
            }
        }

        @keyframes shadow324 {

            0%,
            100% {
                transform: scale(1, 1);
            }

            50% {
                transform: scale(1.2, 1);
            }
        }

        /* Rest of your existing styles... */
        .sidebar {
            background-color: #ffffff;
            color: #4a4a4a;
            width: 250px;
            transition: width 0.3s ease;
            overflow: hidden;
            position: fixed;
            height: 100%;
            z-index: 100;
            border-right: 1px solid #e5e5e5;
        }

        .sidebar.collapsed {
            width: 60px;
        }

        .sidebar-header {
            padding: 20px;
            text-align: center;
            font-size: 18px;
            font-weight: 600;
            border-bottom: 1px solid #e5e5e5;
            display: flex;
            align-items: center;
            justify-content: space-between;
            color: #1a1a1a;
        }

        .toggle-btn {
            background: none;
            border: none;
            color: #6b7280;
            font-size: 18px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 8px;
            border-radius: 6px;
            transition: background-color 0.2s;
        }

        .toggle-btn:hover {
            background-color: #f3f4f6;
        }

        .menu-item {
            display: flex;
            align-items: center;
            padding: 12px 20px;
            color: #6b7280;
            text-decoration: none;
            transition: all 0.2s;
            font-weight: 400;
            font-size: 14px;
        }

        .menu-item:hover {
            background-color: #f8fafc;
            color: #374151;
        }

        .menu-item.active {
            background-color: #f1f5f9;
            color: #0f172a;
            font-weight: 500;
        }

        .menu-item i {
            margin-right: 12px;
            font-size: 16px;
            min-width: 16px;
            text-align: center;
        }

        .sidebar.collapsed .menu-text {
            display: none;
        }

        .main-content {
            flex: 1;
            padding: 32px;
            overflow-y: auto;
            margin-left: 250px;
            transition: margin-left 0.3s ease;
        }

        .main-content.sidebar-collapsed {
            margin-left: 60px;
        }

        .content-header {
            margin-bottom: 32px;
            text-align: center;
            margin-top: 30px;
        }

        .content-header h1 {
            font-size: 36px;
            color: #0f172a;
            margin-bottom: 12px;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .content-header p {
            color: #64748b;
            font-size: 16px;
            font-weight: 400;
        }

        .cards-container {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-top: 40px;
            max-width: 1200px;
            margin-left: auto;
            margin-right: auto;
        }

        .card {
            background-color: white;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            border: 1px solid #e2e8f0;
            text-align: center;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 160px;
            position: relative;
            overflow: hidden;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.08);
        }

        .card i {
            font-size: 36px;
            margin-bottom: 16px;
            opacity: 0.9;
            transition: transform 0.2s ease;
        }

        .card:hover i {
            transform: scale(1.05);
        }

        .card h2 {
            font-size: 18px;
            color: #1e293b;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .card .count {
            color: var(--card-color);
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .card p {
            color: #64748b;
            font-size: 14px;
            font-weight: 500;
        }

        .card-projects {
            --card-color: #3b82f6;
            --card-color-light: #93c5fd;
        }

        .card-projects i {
            color: #3b82f6;
        }

        .card-contacts {
            --card-color: #10b981;
            --card-color-light: #6ee7b7;
        }

        .card-contacts i {
            color: #10b981;
        }

        .card-users {
            --card-color: #8b5cf6;
            --card-color-light: #c4b5fd;
        }

        .card-users i {
            color: #8b5cf6;
        }

        .card-blogs {
            --card-color: #ec4899;
            --card-color-light: #f9a8d4;
        }

        .card-blogs i {
            color: #ec4899;
        }

        .card-create-blog {
            --card-color: #f59e0b;
            --card-color-light: #fcd34d;
        }

        .card-create-blog i {
            color: #f59e0b;
        }

        .page {
            display: none;
        }

        .page.active {
            display: block;
        }

        /* Enhanced Table Styles */
        .table-container {
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            border: 1px solid #e2e8f0;
            overflow: hidden;
            margin-bottom: 32px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background-color: white;
            table-layout: auto;
        }

        th,
        td {
            padding: 16px 20px;
            text-align: left;
            border-bottom: 1px solid #f1f5f9;
            vertical-align: middle;
            word-wrap: break-word;
            white-space: normal;
        }

        th {
            background-color: #f8fafc;
            color: #374151;
            font-weight: 600;
            font-size: 16px;
            position: sticky;
            top: 0;
            padding-top: 18px;
            padding-bottom: 18px;
        }

        td {
            color: #4b5563;
            font-size: 15px;
            line-height: 1.6;
            padding-top: 14px;
            padding-bottom: 14px;
        }

        tr:last-child td {
            border-bottom: none;
        }

        tr:hover {
            background-color: #f3f4f6;
        }

        .table-actions {
            display: flex;
            gap: 10px;
            justify-content: center;
        }

        .empty-table-message {
            padding: 50px 24px;
            text-align: center;
            color: #9ca3af;
            font-size: 16px;
            background-color: #f8fafc;
            border-radius: 0 0 12px 12px;
        }

        .btn {
            padding: 8px 14px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            font-size: 14px;
            transition: all 0.2s;
            white-space: nowrap;
        }

        .btn-edit {
            background-color: #d1fadf;
            color: #047857;
        }

        .btn-edit:hover {
            background-color: #a3e9c7;
        }

        .btn-delete {
            background-color: #ffe4e6;
            color: #b91c1c;
        }

        .btn-delete:hover {
            background-color: #fecaca;
        }

        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.4);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal-container {
            background-color: white;
            border-radius: 12px;
            width: 90%;
            max-width: 420px;
            padding: 28px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
            transform: translateY(-20px);
            transition: transform 0.3s;
        }

        .modal-overlay.active .modal-container {
            transform: translateY(0);
        }

        .modal-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-header i {
            color: #f59e0b;
            font-size: 20px;
            margin-right: 12px;
        }

        .modal-header h3 {
            font-size: 18px;
            color: #1e293b;
            font-weight: 600;
        }

        .modal-body {
            margin-bottom: 28px;
            color: #64748b;
            font-size: 15px;
            line-height: 1.5;
        }

        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 12px;
        }

        .btn-cancel {
            background-color: #f8fafc;
            color: #64748b;
            border: 1px solid #e2e8f0;
        }

        .btn-cancel:hover {
            background-color: #f1f5f9;
        }

        .btn-confirm {
            background-color: #dc2626;
            color: white;
        }

        .btn-confirm:hover {
            background-color: #b91c1c;
        }

        @media (max-width: 1024px) {
            .cards-container {
                grid-template-columns: repeat(2, 1fr);
            }

            .card-create-blog {
                grid-column: span 2;
            }
        }

        @media (max-width: 768px) {
            .sidebar {
                width: 60px;
                position: fixed;
            }

            .sidebar .menu-text {
                display: none;
            }

            .sidebar.expanded {
                width: 250px;
                position: fixed;
                z-index: 999;
                height: 100%;
            }

            .sidebar.expanded .menu-text {
                display: inline;
            }

            .main-content {
                margin-left: 60px;
                padding: 20px;
            }

            .content-header h1 {
                font-size: 28px;
            }

            .content-header p {
                font-size: 14px;
            }

            .cards-container {
                grid-template-columns: 1fr;
                gap: 16px;
                margin-top: 30px;
            }

            .card {
                min-height: 140px;
                padding: 20px;
            }

            .card-create-blog {
                grid-column: span 1;
                width: 100%;
            }

            .card i {
                font-size: 32px;
            }

            .card .count {
                font-size: 24px;
            }

            th,
            td {
                padding: 12px 10px;
                font-size: 13px;
            }
        }

        /* Users Table Specific Styles */
        #users-table th:nth-child(4),
        #users-table td:nth-child(4) {
            min-width: 120px;
        }

        #users-table th:nth-child(5),
        #users-table td:nth-child(5),
        #users-table th:nth-child(6),
        #users-table td:nth-child(6) {
            text-align: center;
            width: 80px;
        }

        /* Blog Section Specific Styles */
        .blog-management-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 14px 0px 16px 20px;
        }

        .blog-management-header h3 {
            font-size: 18px;
            color: #1e293b;
            font-weight: 600;
        }

        .create-blog-card {
            background-color: white;
            border-radius: 8px;
            padding: 16px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            border: 1px solid #e2e8f0;
            margin-bottom: 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .btn-primary {
            background-color: #3b82f6;
            color: white;
            padding: 8px 16px;
            border-radius: 6px;
            font-weight: 500;
            font-size: 14px;
            border: none;
            cursor: pointer;
            transition: background-color 0.2s;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        /* Blog Form Page Styles */
        .blog-form-container {
            max-width: 800px;
            margin: 0 auto;
            background-color: white;
            border-radius: 12px;
            padding: 32px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.04);
            border: 1px solid #e2e8f0;
        }

        .blog-form-group {
            margin-bottom: 24px;
        }

        .blog-form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #374151;
            font-size: 15px;
        }

        .blog-form-control {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            font-size: 15px;
            transition: all 0.3s ease;
            background-color: #f8fafc;
        }

        .blog-form-control:focus {
            outline: none;
            border-color: #93c5fd;
            box-shadow: 0 0 0 3px rgba(147, 197, 253, 0.2);
            background-color: #fff;
        }

        .blog-form-control.textarea {
            min-height: 150px;
            resize: vertical;
            line-height: 1.6;
        }

        .image-upload-container {
            margin-top: 10px;
        }

        .current-image-container {
            margin-top: 15px;
            padding: 12px;
            background-color: #f8fafc;
            border-radius: 8px;
            border: 1px dashed #e2e8f0;
        }

        .current-image-label {
            font-size: 14px;
            color: #64748b;
            margin-bottom: 8px;
            display: block;
        }

        .current-image-preview {
            max-width: 100%;
            max-height: 200px;
            border-radius: 8px;
            margin-top: 8px;
            display: block;
            margin: 8px auto 0;
        }

        .file-input-label {
            display: inline-block;
            padding: 10px 16px;
            background-color: #f1f5f9;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            color: #334155;
            transition: background-color 0.2s;
            border: 1px solid #e2e8f0;
        }

        .file-input-label:hover {
            background-color: #e2e8f0;
        }

        .file-input {
            display: none;
        }

        .file-selected-message {
            font-size: 14px;
            color: #10b981;
            margin-top: 8px;
            display: none;
            align-items: center;
            gap: 6px;
        }

        .form-actions {
            display: flex;
            justify-content: flex-end;
            gap: 16px;
            margin-top: 32px;
        }

        .btn-submit {
            background-color: #3b82f6;
            color: white;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 500;
            font-size: 15px;
            border: none;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .btn-submit:hover {
            background-color: #2563eb;
        }

        .btn-submit:disabled {
            background-color: #93c5fd;
            cursor: not-allowed;
        }

        /* Blog Table Styles */
        #blogs-table th:nth-child(1),
        #blogs-table td:nth-child(1) {
            width: 40px;
        }

        #blogs-table th:nth-child(4),
        #blogs-table td:nth-child(4) {
            width: 100px;
        }

        #blogs-table th:nth-child(5),
        #blogs-table td:nth-child(5) {
            width: 120px;
            text-align: center;
        }

        /* Image Preview Styles */
        .image-preview-container {
            margin-top: 15px;
            display: none;
            padding: 12px;
            background-color: #f8fafc;
            border-radius: 8px;
            border: 1px dashed #e2e8f0;
        }

        .image-preview-label {
            font-size: 14px;
            color: #64748b;
            margin-bottom: 8px;
            display: block;
        }

        .image-preview {
            max-width: 100%;
            max-height: 200px;
            border-radius: 8px;
            margin-top: 10px;
            display: block;
            border: 1px solid #e2e8f0;
            margin: 8px auto 0;
        }

        /* Toast Notification */
        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: #10b981;
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 1000;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 10px;
            transform: translateY(30px);
            opacity: 0;
            transition: all 0.3s ease;
        }

        .toast.show {
            transform: translateY(0);
            opacity: 1;
        }

        .toast i {
            font-size: 18px;
        }

        .toast.error {
            background-color: #ef4444;
        }

        .toast.warning {
            background-color: #f59e0b;
        }

        .toast.info {
            background-color: #3b82f6;
        }

        /* Logout Button Styles */
        .menu-item.logout {
            margin-top: auto;
            color: #ef4444;
            border-top: 1px solid #e5e5e5;
        }

        .menu-item.logout:hover {
            background-color: #fef2f2;
            color: #dc2626;
        }

        .menu-item.logout i {
            color: #ef4444;
        }

        /* Editor Toolbar Styles */
.editor-toolbar {
    display: flex;
    gap: 8px;
    margin-bottom: 8px;
    padding: 8px;
    background-color: #f8fafc;
    border-radius: 6px;
    border: 1px solid #e2e8f0;
}

.toolbar-btn {
    background: none;
    border: none;
    padding: 6px 10px;
    border-radius: 4px;
    cursor: pointer;
    color: #4b5563;
    font-size: 14px;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 32px;
    height: 32px;
}

.toolbar-btn:hover {
    background-color: #e2e8f0;
    color: #1e293b;
}

.toolbar-btn.active {
    background-color: #3b82f6;
    color: white;
}

.toolbar-btn i {
    font-size: 14px;
}

#editor {
    min-height: 150px;
    padding: 12px 16px;
    background-color: #fff;
    border: 1px solid #e2e8f0;
    border-radius: 0 0 8px 8px;
    border-top: none;
    font-size: 15px;
    line-height: 1.6;
    outline: none;
}

#editor:focus {
    border-color: #93c5fd;
    box-shadow: 0 0 0 3px rgba(147, 197, 253, 0.2);
}

.editor-toolbar {
    border-radius: 8px 8px 0 0;
    border-bottom: none;
    flex-wrap: wrap;
}
    </style>
</head>

<body>
    <!-- Page Loader -->
    <div id="page-loader">
        <div class="loader"></div>
    </div>

    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <span class="menu-text">VI</span>
            <button class="toggle-btn" id="toggle-sidebar">
                ‚â°
            </button>
        </div>
        <a href="#" class="menu-item" data-page="home">
            <i>üè†</i>
            <span class="menu-text">Dashboard</span>
        </a>
        <a href="#" class="menu-item" data-page="projects">
            <i>üìÅ</i>
            <span class="menu-text">Projects</span>
        </a>
        <a href="#" class="menu-item" data-page="contacts">
            <i>üë§</i>
            <span class="menu-text">Contacts</span>
        </a>
        <a href="#" class="menu-item" data-page="blogs">
            <i>üì∞</i>
            <span class="menu-text">Blogs</span>
        </a>
        <a href="#" class="menu-item" data-page="create-blog">
            <i>‚úèÔ∏è</i>
            <span class="menu-text">Create Blog</span>
        </a>
        <a href="#" class="menu-item" data-page="users">
            <i>üë•</i>
            <span class="menu-text">Users</span>
        </a>
        <a href="/admin_logout" class="menu-item logout">
            <i>‚Ü™</i>
            <span class="menu-text">Logout</span>
        </a>
    </div>

    <div class="main-content" id="main-content">
        <!-- Home/Dashboard Page -->
        <div class="page active" id="home">
            <div class="content-header">
                <h1>Welcome, Administrator</h1>
                <p>Manage your dashboard and monitor system activity</p>
            </div>

            <div class="cards-container">
                <div class="card card-projects" data-page="projects">
                    <i>üìÅ</i>
                    <h2>Projects</h2>
                    <div class="count" id="projects-count">
                        <% if (projects && projects.length> 0) { %>
                            <%= projects.length %>
                                <% } else { %>
                                    0
                                    <% } %>
                    </div>
                    <p>Total Messages</p>
                </div>
                <div class="card card-contacts" data-page="contacts">
                    <i>üë§</i>
                    <h2>Contacts</h2>
                    <div class="count" id="contacts-count">
                        <% if (contacts && contacts.length> 0) { %>
                            <%= contacts.length %>
                                <% } else { %>
                                    0
                                    <% } %>
                    </div>
                    <p>Total Messages</p>
                </div>
                <div class="card card-users" data-page="users">
                    <i>üë•</i>
                    <h2>Users</h2>
                    <div class="count" id="users-count">
                        <% if (users && users.length> 0) { %>
                            <%= users.length %>
                                <% } else { %>
                                    0
                                    <% } %>
                    </div>
                    <p>Registered Users</p>
                </div>
                <div class="card card-blogs" data-page="blogs">
                    <i>üì∞</i>
                    <h2>Blogs</h2>
                    <div class="count" id="blogs-count">0</div>
                    <p>Total Posts</p>
                </div>

                <div class="card card-create-blog" data-page="create-blog">
                    <i>‚úèÔ∏è</i>
                    <h2>Create Blog</h2>
                    <p>Create a new blog post</p>
                </div>
            </div>
        </div>

        <!-- Projects Page -->
        <div class="page" id="projects">
            <div class="content-header">
                <h1>Projects</h1>
                <p>Manage projects page submissions</p>
            </div>

            <!-- Projects Table -->
            <div class="table-container">
                <table id="projects-table">
                    <thead>
                        <tr>
                            <th style="width: 60px;">S.No</th>
                            <th style="width: 180px;">Email</th>
                            <th>Message</th>
                            <th style="width: 100px;">Date</th>
                            <th style="width: 120px;">Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <% if (projects && projects.length> 0) { %>
                            <% projects.forEach((project, index)=> { %>
                                <tr>
                                    <td>
                                        <%= index + 1 %>
                                    </td>
                                    <td>
                                        <%= project.email %>
                                    </td>
                                    <td>
                                        <%= project.message %>
                                    </td>
                                    <td>
                                        <%= new Date(project.createdAt).toLocaleDateString() %>
                                    </td>
                                    <td class="table-actions">
                                        <button class="btn btn-delete" data-id="<%= project._id %>"
                                            data-type="project">Delete</button>
                                    </td>
                                </tr>
                                <% }); %>
                                    <% } else { %>
                                        <tr>
                                            <td colspan="5" class="empty-table-message">No projects data available</td>
                                        </tr>
                                        <% } %>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Contacts Page -->
        <div class="page" id="contacts">
            <div class="content-header">
                <h1>Contacts</h1>
                <p>Manage contacts page submissions</p>
            </div>

            <div class="table-container">
                <table id="contacts-table">
                    <thead>
                        <tr>
                            <th style="width: 60px;">S.No</th>
                            <th style="width: 120px;">Name</th>
                            <th style="width: 180px;">Email</th>
                            <th style="width: 150px;">Subject</th>
                            <th>Message</th>
                            <th style="width: 100px;">Date</th>
                            <th style="width: 140px;">Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <% if (contacts && contacts.length> 0) { %>
                            <% contacts.forEach((contact, index)=> { %>
                                <tr>
                                    <td>
                                        <%= index + 1 %>
                                    </td>
                                    <td>
                                        <%= contact.name %>
                                    </td>
                                    <td>
                                        <%= contact.email %>
                                    </td>
                                    <td>
                                        <%= contact.subject %>
                                    </td>
                                    <td>
                                        <%= contact.message %>
                                    </td>
                                    <td>
                                        <%= new Date(contact.createdAt).toLocaleDateString() %>
                                    </td>
                                    <td class="table-actions">
                                        <button class="btn btn-delete" data-id="<%= contact._id %>"
                                            data-type="contact">Delete</button>
                                    </td>
                                </tr>
                                <% }); %>
                                    <% } else { %>
                                        <tr>
                                            <td colspan="7" class="empty-table-message">No contacts data available</td>
                                        </tr>
                                        <% } %>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Blogs Page -->
        <div class="page" id="blogs">
            <div class="content-header">
                <h1>Blog Management</h1>
                <p>Manage your blog posts</p>
            </div>

            <!-- Blogs Table -->
            <div class="table-container">
                <div class="blog-management-header">
                    <h3>Blog Posts</h3>
                </div>

                <table id="blogs-table">
                    <thead>
                        <tr>
                            <th style="width: 60px;">S.No</th>
                            <th>Title</th>
                            <th style="width: 120px;">Category</th>
                            <th style="width: 100px;">Date</th>
                            <th style="width: 140px;">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="blogs-table-body">
                        <tr>
                            <td colspan="5" class="empty-table-message">Loading blog posts...</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Replace the existing create-blog page content with this -->
<div class="page" id="create-blog">
    <div class="content-header">
        <h1>Create Blog Post</h1>
        <p>Write and publish a new blog post</p>
    </div>

    <div class="blog-form-container">
        <form id="blog-form">
            <input type="hidden" id="blog-id">

            <div class="blog-form-group">
                <label for="blog-title">Title*</label>
                <input type="text" id="blog-title" class="blog-form-control" required placeholder="Enter blog title">
            </div>

            <div class="blog-form-group">
                <label for="blog-category">Category*</label>
                <input type="text" id="blog-category" class="blog-form-control" required placeholder="e.g., Technology, Business">
            </div>

            <div class="blog-form-group">
                <label for="blog-excerpt">Short Description*</label>
                <textarea id="blog-excerpt" class="blog-form-control" rows="3" required placeholder="A brief summary of your blog post"></textarea>
            </div>

            <div class="blog-form-group">
                <label for="blog-content">Content</label>
                <div class="editor-toolbar">
                    <button type="button" class="toolbar-btn" data-command="bold" title="Bold">
                        <i class="fas fa-bold"></i>
                    </button>
                    <button type="button" class="toolbar-btn" data-command="italic" title="Italic">
                        <i class="fas fa-italic"></i>
                    </button>
                    <button type="button" class="toolbar-btn" data-command="underline" title="Underline">
                        <i class="fas fa-underline"></i>
                    </button>
                    <button type="button" class="toolbar-btn" data-command="strikeThrough" title="Strike Through">
                        <i class="fas fa-strikethrough"></i>
                    </button>
                    <button type="button" class="toolbar-btn" data-command="justifyLeft" title="Align Left">
                        <i class="fas fa-align-left"></i>
                    </button>
                    <button type="button" class="toolbar-btn" data-command="justifyCenter" title="Align Center">
                        <i class="fas fa-align-center"></i>
                    </button>
                    <button type="button" class="toolbar-btn" data-command="justifyRight" title="Align Right">
                        <i class="fas fa-align-right"></i>
                    </button>
                    <button type="button" class="toolbar-btn" data-command="insertUnorderedList" title="Bullet List">
                        <i class="fas fa-list-ul"></i>
                    </button>
                    <button type="button" class="toolbar-btn" data-command="insertOrderedList" title="Numbered List">
                        <i class="fas fa-list-ol"></i>
                    </button>
                </div>
                <div id="editor" class="blog-form-control" contenteditable="true"></div>
                <textarea id="blog-content" name="content" class="blog-form-control textarea" style="display: none;"></textarea>
            </div>

            <div class="blog-form-group">
                <label for="blog-image">Featured Image</label>
                <label for="blog-image" class="file-input-label">
                    <i class="fas fa-image"></i> Choose Image
                </label>
                <input type="file" id="blog-image" class="file-input" accept="image/*">
                <div class="file-selected-message" id="file-selected-message">
                    <i class="fas fa-check-circle"></i> Image selected
                </div>

                <!-- Image preview container -->
                <div id="image-preview-container" class="image-preview-container">
                    <span class="image-preview-label">Selected Image Preview:</span>
                    <img id="image-preview" class="image-preview" src="">
                </div>

                <!-- Current image container (for editing existing blog) -->
                <div id="current-image-container" class="current-image-container" style="display: none;">
                    <span class="current-image-label">Current Image:</span>
                    <img id="current-image-preview" class="current-image-preview" src="">
                </div>
            </div>

            <div class="form-actions">
                <button type="reset" class="btn btn-cancel">Reset</button>
                <button type="submit" class="btn-submit" id="save-blog-btn">Publish</button>
            </div>
        </form>
    </div>
</div>

        <!-- Users Page -->
        <div class="page" id="users">
            <div class="content-header">
                <h1>Users</h1>
                <p>Manage registered user accounts</p>
            </div>

            <div class="table-container">
                <table id="users-table">
                    <thead>
                        <tr>
                            <th style="width: 60px;">S.No</th>
                            <th>Name</th>
                            <th style="width: 200px;">Email</th>
                            <th style="width: 120px;">Profession</th>
                            <th style="width: 80px;">PDFs</th>
                            <th style="width: 80px;">Images</th>
                            <th style="width: 140px;">Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <% if (users && users.length> 0) { %>
                            <% users.forEach((user, index)=> { %>
                                <tr>
                                    <td>
                                        <%= index + 1 %>
                                    </td>
                                    <td>
                                        <%= user.name %>
                                    </td>
                                    <td>
                                        <%= user.email %>
                                    </td>
                                    <td>
                                        <%= user.profession %>
                                    </td>
                                    <td style="text-align: center;">
                                        <%= user.pdfs ? user.pdfs.length : 0 %>
                                    </td>
                                    <td style="text-align: center;">
                                        <%= user.images ? user.images.length : 0 %>
                                    </td>
                                    <td class="table-actions">
                                        <button class="btn btn-delete" data-id="<%= user._id %>" data-type="user">Remove
                                            Access</button>
                                    </td>
                                </tr>
                                <% }); %>
                                    <% } else { %>
                                        <tr>
                                            <td colspan="7" class="empty-table-message">No users registered</td>
                                        </tr>
                                        <% } %>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div class="modal-overlay" id="delete-confirmation-modal">
        <div class="modal-container">
            <div class="modal-header">
                <i>‚ö†Ô∏è</i>
                <h3>Delete ?</h3>
            </div>
            <div class="modal-body">
                <p>Are you sure you want to remove this ? This action cannot be undone.</p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-cancel" id="cancel-delete">Cancel</button>
                <button class="btn btn-confirm" id="confirm-delete">Delete</button>
            </div>
        </div>
    </div>

    <!-- Blog Delete Confirmation Modal -->
    <div class="modal-overlay" id="blog-delete-confirmation-modal">
        <div class="modal-container">
            <div class="modal-header">
                <i>‚ö†Ô∏è</i>
                <h3>Delete Blog Post ?</h3>
            </div>
            <div class="modal-body">
                <p>Are you sure you want to delete this blog post ?
                    This action cannot be undone.</p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-cancel" id="cancel-blog-delete">Cancel</button>
                <button class="btn btn-confirm" id="confirm-blog-delete">Delete</button>
            </div>
        </div>
    </div>

    <script>
        // Show loader for 1 seconds when page loads
        document.addEventListener('DOMContentLoaded', function () {
            setTimeout(function () {
                document.getElementById('page-loader').style.opacity = '0';
                setTimeout(function () {
                    document.getElementById('page-loader').style.display = 'none';
                }, 500);
            }, 1000);
        });

        // Editor functionality
document.addEventListener('DOMContentLoaded', function() {
    const editor = document.getElementById('editor');
    const contentTextarea = document.getElementById('blog-content');
    const toolbarButtons = document.querySelectorAll('.toolbar-btn');

    // Initialize editor with existing content if any
    editor.addEventListener('input', function() {
        contentTextarea.value = editor.innerHTML;
    });

    // Set initial content when editing a blog
    if (contentTextarea.value) {
        editor.innerHTML = contentTextarea.value;
    }

    // Handle toolbar buttons
    toolbarButtons.forEach(button => {
        button.addEventListener('click', function() {
            const command = this.dataset.command;
            if (command === 'createLink') {
                const url = prompt('Enter the link URL:');
                if (url) document.execCommand(command, false, url);
            } else {
                document.execCommand(command, false, null);
            }
            editor.focus();
        });
    });

    // Update textarea before form submission
    const blogForm = document.getElementById('blog-form');
    if (blogForm) {
        blogForm.addEventListener('submit', function() {
            contentTextarea.value = editor.innerHTML;
        });
    }
});

        // Toggle sidebar functionality
        const sidebar = document.getElementById('sidebar');
        const toggleBtn = document.getElementById('toggle-sidebar');
        const mainContent = document.getElementById('main-content');

        toggleBtn.addEventListener('click', () => {
            sidebar.classList.toggle('collapsed');
            mainContent.classList.toggle('sidebar-collapsed');

            if (window.innerWidth <= 768) {
                sidebar.classList.toggle('expanded');
            }
        });

        // Page navigation
        const menuItems = document.querySelectorAll('.menu-item[data-page]');
        const pages = document.querySelectorAll('.page');

        menuItems.forEach(item => {
            item.addEventListener('click', (e) => {
                e.preventDefault();

                // Remove active class from all menu items
                menuItems.forEach(i => i.classList.remove('active'));

                // Add active class to clicked menu item
                item.classList.add('active');

                // Hide all pages
                pages.forEach(page => page.classList.remove('active'));

                // Show the target page
                const targetPageId = item.getAttribute('data-page');
                document.getElementById(targetPageId).classList.add('active');

                // On mobile, collapse sidebar after navigation
                if (window.innerWidth <= 768) {
                    sidebar.classList.remove('expanded');
                }
            });
        });

        // Add click functionality to dashboard cards
        document.querySelectorAll('.card[data-page]').forEach(card => {
            card.addEventListener('click', (e) => {
                const targetPage = card.getAttribute('data-page');

                // Remove active class from all menu items
                menuItems.forEach(i => i.classList.remove('active'));

                // Add active class to corresponding menu item
                const correspondingMenuItem = document.querySelector(`.menu-item[data-page="${targetPage}"]`);
                if (correspondingMenuItem) {
                    correspondingMenuItem.classList.add('active');
                }

                // Hide all pages
                pages.forEach(page => page.classList.remove('active'));

                // Show the target page
                document.getElementById(targetPage).classList.add('active');
            });
        });

        // Set Home as default active page
        document.querySelector('.menu-item[data-page="home"]').classList.add('active');

        // Handle responsive behavior
        const handleResize = () => {
            if (window.innerWidth <= 768) {
                sidebar.classList.add('collapsed');
                mainContent.classList.add('sidebar-collapsed');

                // Add toggle for mobile
                sidebar.addEventListener('click', (e) => {
                    if (e.target.closest('.menu-item') && window.innerWidth <= 768) {
                        sidebar.classList.remove('expanded');
                    }
                });
            } else {
                if (sidebar.classList.contains('collapsed')) {
                    mainContent.classList.add('sidebar-collapsed');
                } else {
                    mainContent.classList.remove('sidebar-collapsed');
                }
            }
        };

        // Initial setup
        window.addEventListener('resize', handleResize);
        handleResize();

        // Show toast notification
        function showToast(message, type = 'success') {
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.innerHTML = `
                <i class="fas ${type === 'error' ? 'fa-exclamation-circle' : 'fa-check-circle'}"></i>
                <span>${message}</span>
            `;

            document.body.appendChild(toast);

            // Show toast
            setTimeout(() => {
                toast.classList.add('show');
            }, 10);

            // Hide after 3 seconds
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => {
                    toast.remove();
                }, 300);
            }, 3000);
        }

        // Confirmation Modal Handling
        document.addEventListener('DOMContentLoaded', function () {
            const modal = document.getElementById('delete-confirmation-modal');
            const cancelBtn = document.getElementById('cancel-delete');
            const confirmBtn = document.getElementById('confirm-delete');

            let currentItemId = null;
            let currentItemType = null;
            let currentRow = null;

            // Handle delete buttons click
            document.querySelectorAll('.btn-delete').forEach(button => {
                button.addEventListener('click', function (e) {
                    e.preventDefault();
                    currentItemId = this.getAttribute('data-id');
                    currentItemType = this.getAttribute('data-type');
                    currentRow = this.closest('tr');

                    // Update modal text based on type
                    const modalTitle = document.querySelector('#delete-confirmation-modal .modal-header h3');
                    const modalBody = document.querySelector('#delete-confirmation-modal .modal-body p');

                    if (currentItemType === 'project') {
                        modalTitle.textContent = 'Delete Project Submission ?';
                        modalBody.textContent = 'Are you sure you want to delete this project submission? This action cannot be undone.';
                    } else if (currentItemType === 'contact') {
                        modalTitle.textContent = 'Delete Contact Message ?';
                        modalBody.textContent = 'Are you sure you want to delete this contact message ? This action cannot be undone.';
                    } else if (currentItemType === 'user') {
                        modalTitle.textContent = 'Remove User Access ?';
                        modalBody.textContent = 'Are you sure you want to remove this user\'s access ? This action cannot be undone.';
                    }

                    // Show the modal
                    modal.classList.add('active');
                });
            });

            // Handle cancel button click
            cancelBtn.addEventListener('click', function () {
                modal.classList.remove('active');
                currentItemId = null;
                currentItemType = null;
                currentRow = null;
            });

            // Handle clicking outside the modal to close
            modal.addEventListener('click', function (e) {
                if (e.target === modal) {
                    modal.classList.remove('active');
                    currentItemId = null;
                    currentItemType = null;
                    currentRow = null;
                }
            });

            // Handle confirm delete button click
            confirmBtn.addEventListener('click', async function () {
                if (currentItemId && currentItemType && currentRow) {
                    try {
                        let endpoint = '';

                        if (currentItemType === 'contact') {
                            endpoint = `/admin/contacts/${currentItemId}`;
                        } else if (currentItemType === 'project') {
                            endpoint = `/admin/projects/${currentItemId}`;
                        } else if (currentItemType === 'user') {
                            endpoint = `/admin/users/${currentItemId}`;
                        }

                        const response = await fetch(endpoint, {
                            method: 'DELETE',
                            headers: {
                                'Content-Type': 'application/json'
                            }
                        });

                        if (response.ok) {
                            // Remove the row from the table
                            currentRow.remove();

                            // Update the dashboard counts
                            updateDashboardCounts(currentItemType);

                            // Show success toast
                            let message = '';
                            if (currentItemType === 'project') {
                                message = 'Project submission deleted successfully !';
                            } else if (currentItemType === 'contact') {
                                message = 'Contact message deleted successfully !';
                            } else if (currentItemType === 'user') {
                                message = 'User removed successfully !';
                            }
                            showToast(message);

                            // Check if table is now empty and add empty message if needed
                            const tableId = `${currentItemType}s-table`;
                            const tbody = document.querySelector(`#${tableId} tbody`);

                            if (tbody && tbody.children.length === 0) {
                                const colspan = currentItemType === 'contact' ? 7 :
                                    currentItemType === 'project' ? 5 : 7;
                                const emptyRow = document.createElement('tr');
                                emptyRow.innerHTML = `<td colspan="${colspan}" class="empty-table-message">No ${currentItemType}s data available</td>`;
                                tbody.appendChild(emptyRow);
                            }
                        } else {
                            throw new Error('Failed to delete item');
                        }
                    } catch (error) {
                        console.error('Error:', error);
                        showToast(`Error deleting ${currentItemType}`, 'error');
                    } finally {
                        // Reset current item variables
                        currentItemId = null;
                        currentItemType = null;
                        currentRow = null;

                        // Close the modal
                        modal.classList.remove('active');
                    }
                }
            });
        });

        // Function to update dashboard counts after deletion
        function updateDashboardCounts(itemType) {
            const countElement = document.getElementById(`${itemType}s-count`);
            if (countElement) {
                const currentCount = parseInt(countElement.textContent);
                const newCount = Math.max(0, currentCount - 1);
                countElement.textContent = newCount;
            }
        }

        // Enhanced Blog Management Script
        document.addEventListener('DOMContentLoaded', function () {
            const blogDeleteModal = document.getElementById('blog-delete-confirmation-modal');
            const cancelBlogDeleteBtn = document.getElementById('cancel-blog-delete');
            const confirmBlogDeleteBtn = document.getElementById('confirm-blog-delete');
            const imageInput = document.getElementById('blog-image');
            const fileSelectedMessage = document.getElementById('file-selected-message');
            const imagePreviewContainer = document.getElementById('image-preview-container');
            const imagePreview = document.getElementById('image-preview');
            const blogForm = document.getElementById('blog-form');
            const saveBlogBtn = document.getElementById('save-blog-btn');

            let blogToDeleteId = null;

            // Show image preview when file is selected
            imageInput.addEventListener('change', function () {
                if (this.files && this.files[0]) {
                    const reader = new FileReader();

                    reader.onload = function (e) {
                        imagePreview.src = e.target.result;
                        imagePreviewContainer.style.display = 'block';
                        fileSelectedMessage.style.display = 'flex';
                    }

                    reader.readAsDataURL(this.files[0]);
                } else {
                    imagePreviewContainer.style.display = 'none';
                    fileSelectedMessage.style.display = 'none';
                }
            });

            function loadBlogs() {
                fetch('/api/blogs')
                    .then(response => response.json())
                    .then(blogs => {
                        const tableBody = document.getElementById('blogs-table-body');
                        tableBody.innerHTML = '';

                        // Update blog count on dashboard
                        document.getElementById('blogs-count').textContent = blogs.length;

                        if (blogs.length === 0) {
                            tableBody.innerHTML = '<tr><td colspan="5" class="empty-table-message">No blog posts available</td></tr>';
                            return;
                        }

                        blogs.forEach((blog, index) => {
                            const row = document.createElement('tr');
                            row.innerHTML = `
                                <td>${index + 1}</td>
                                <td>${blog.title}</td>
                                <td>${blog.category}</td>
                                <td>${new Date(blog.createdAt).toLocaleDateString()}</td>
                                <td class="table-actions">
                                    <button class="btn btn-edit edit-blog-btn" data-id="${blog._id}">
                                        Edit
                                    </button>
                                    <button class="btn btn-delete delete-blog-btn" data-id="${blog._id}">
                                        Delete
                                    </button>
                                </td>
                            `;
                            tableBody.appendChild(row);
                        });

                        // Add event listeners to edit buttons
                        document.querySelectorAll('.edit-blog-btn').forEach(btn => {
                            btn.addEventListener('click', async (e) => {
                                const blogId = e.currentTarget.getAttribute('data-id');
                                try {
                                    const response = await fetch(`/api/blogs/${blogId}`);
                                    const blog = await response.json();

                                    // Navigate to create-blog page
                                    document.querySelector('.menu-item[data-page="create-blog"]').click();

                                    // Populate the form with blog data
                                    document.getElementById('blog-id').value = blog._id;
                                    document.getElementById('blog-title').value = blog.title;
                                    document.getElementById('blog-excerpt').value = blog.excerpt;
                                    document.getElementById('blog-content').value = blog.content;
                                    document.getElementById('blog-category').value = blog.category;

                                    // Show current image if exists
                                    const imageContainer = document.getElementById('current-image-container');
                                    if (blog.imageUrl) {
                                        imageContainer.style.display = 'block';
                                        document.getElementById('current-image-preview').src = blog.imageUrl;
                                    } else {
                                        imageContainer.style.display = 'none';
                                    }

                                    // Hide new image preview if showing
                                    imagePreviewContainer.style.display = 'none';
                                    fileSelectedMessage.style.display = 'none';

                                    // Update the submit button text
                                    document.getElementById('save-blog-btn').textContent = 'Update Post';
                                } catch (error) {
                                    console.error('Error loading blog:', error);
                                    showToast('Error loading blog for editing', 'error');
                                }
                            });
                        });

                        // Add event listeners to delete buttons
                        document.querySelectorAll('.delete-blog-btn').forEach(btn => {
                            btn.addEventListener('click', (e) => {
                                blogToDeleteId = e.currentTarget.getAttribute('data-id');
                                blogDeleteModal.classList.add('active');
                            });
                        });
                    })
                    .catch(error => {
                        console.error('Error loading blogs:', error);
                        const tableBody = document.getElementById('blogs-table-body');
                        tableBody.innerHTML = '<tr><td colspan="5" class="empty-table-message">Error loading blog posts</td></tr>';
                    });
            }

            // Handle blog delete confirmation
            confirmBlogDeleteBtn.addEventListener('click', () => {
                if (blogToDeleteId) {
                    deleteBlog(blogToDeleteId);
                }
                blogDeleteModal.classList.remove('active');
                blogToDeleteId = null;
            });

            // Handle blog delete cancellation
            cancelBlogDeleteBtn.addEventListener('click', () => {
                blogDeleteModal.classList.remove('active');
                blogToDeleteId = null;
            });

            // Close blog delete modal when clicking outside
            blogDeleteModal.addEventListener('click', (e) => {
                if (e.target === blogDeleteModal) {
                    blogDeleteModal.classList.remove('active');
                    blogToDeleteId = null;
                }
            });

            // Handle blog form submission
            blogForm.addEventListener('submit', async (e) => {
                e.preventDefault();

                const blogId = document.getElementById('blog-id').value;
                const title = document.getElementById('blog-title').value.trim();
                const excerpt = document.getElementById('blog-excerpt').value.trim();
                const content = document.getElementById('blog-content').value.trim();
                const category = document.getElementById('blog-category').value.trim();

                if (!title || !excerpt || !content || !category) {
                    showToast('Please fill in all required fields', 'error');
                    return;
                }

                const formData = new FormData();
                formData.append('title', title);
                formData.append('excerpt', excerpt);
                formData.append('content', content);
                formData.append('category', category);

                if (imageInput.files[0]) {
                    formData.append('image', imageInput.files[0]);
                }

                const url = blogId ? `/api/blogs/${blogId}` : '/api/blogs';
                const method = blogId ? 'PUT' : 'POST';

                saveBlogBtn.disabled = true;
                saveBlogBtn.innerHTML = blogId ? '<i class="fas fa-spinner fa-spin"></i> Updating...' : '<i class="fas fa-spinner fa-spin"></i> Publishing...';

                try {
                    const response = await fetch(url, {
                        method: method,
                        body: formData
                    });

                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }

                    const data = await response.json();

                    // Reset form
                    blogForm.reset();
                    document.getElementById('current-image-container').style.display = 'none';
                    imagePreviewContainer.style.display = 'none';
                    fileSelectedMessage.style.display = 'none';
                    document.getElementById('blog-id').value = '';

                    // Update the submit button text
                    saveBlogBtn.textContent = 'Publish Post';

                    // Reload blogs list
                    loadBlogs();

                    // Show success message
                    showToast(blogId ? 'Blog updated successfully!' : 'Blog published successfully!');

                    // Navigate to blogs page
                    document.querySelector('.menu-item[data-page="blogs"]').click();

                } catch (error) {
                    console.error('Error saving blog:', error);
                    showToast('Error saving blog: ' + error.message, 'error');
                } finally {
                    saveBlogBtn.disabled = false;
                    saveBlogBtn.innerHTML = blogId ? 'Update Post' : 'Publish Post';
                }
            });

            // Delete blog with confirmation
            function deleteBlog(blogId) {
                fetch(`/api/blogs/${blogId}`, {
                    method: 'DELETE',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                })
                    .then(response => {
                        if (response.ok) {
                            loadBlogs();
                            showToast('Blog deleted successfully!');

                            // Update blog count on dashboard
                            const countElement = document.getElementById('blogs-count');
                            if (countElement) {
                                const currentCount = parseInt(countElement.textContent);
                                const newCount = Math.max(0, currentCount - 1);
                                countElement.textContent = newCount;
                            }
                        } else {
                            throw new Error('Failed to delete blog');
                        }
                    })
                    .catch(error => {
                        console.error('Error deleting blog:', error);
                        showToast('Error deleting blog: ' + error.message, 'error');
                    });
            }

            // Initial load of blogs
            loadBlogs();
        });
    </script>
</body>

</html>